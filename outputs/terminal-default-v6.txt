  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Stratum sends anonymized scan statistics to improve agent   â”‚
  â”‚  security research. No source code, file paths, or secrets   â”‚
  â”‚  are collected. See: docs/telemetry.md                       â”‚
  â”‚                                                              â”‚
  â”‚  Disable:  stratum config set telemetry off                  â”‚
  â”‚  One-time: stratum scan . --no-telemetry                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 â•”=================================================================â•—
 â•‘  STRATUM SCAN                                                   â•‘
 â•‘  crewAI-examples Â· 116 files Â· 30 crews Â· 56 agents             â•‘
 â•‘  Frameworks: CrewAI, LangChain, LangGraph                       â•‘
 â•‘                                                                  â•‘
 â•‘  Risk Score: 69/100                                              â•‘
 â•š=================================================================â•

 â”€â”€â”€ YOUR AGENT ARCHITECTURE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

 RecruitmentCrew (4 agents, sequential)  19/100
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                                                                   â”‚
 â”‚   researcher â”€â”€â–¶ matcher â”€â”€â–¶ communica.. â”€â”€â–¶ reporter             â”‚
 â”‚     matcher: FileReadTool, CSVSearchTool, SerperDevTool (+1)      â”‚
 â”‚     researcher: SerperDevTool, ScrapeWebsiteTool, LinkedInTool    â”‚
 â”‚     communicator: SerperDevTool, ScrapeWebsiteTool                â”‚
 â”‚                                                                   â”‚
 â”‚   â˜¢ STRATUM-CR05.1: Shared tool blast radius: ScrapeWebsiteTool - â”‚
 â”‚   ğŸ”´ ScrapeWebsiteTool shared by 3 agents                          â”‚
 â”‚   ğŸ”´ SerperDevTool shared by 2 agents                              â”‚
 â”‚                                                                   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 StockAnalysisCrew (4 agents, sequential)  19/100
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                                                                   â”‚
 â”‚   financial.. â”€â”€â–¶ research_.. â”€â”€â–¶ financial.. â”€â”€â–¶ investmen..     â”‚
 â”‚     financial_agent: ScrapeWebsiteTool, WebsiteSearchTool, Calcul â”‚
 â”‚     research_analyst_agent: ScrapeWebsiteTool, SEC10QTool, SEC10K â”‚
 â”‚     financial_analyst_agent: ScrapeWebsiteTool, WebsiteSearchTool â”‚
 â”‚     investment_advisor_agent: ScrapeWebsiteTool, WebsiteSearchToo â”‚
 â”‚                                                                   â”‚
 â”‚   â˜¢ STRATUM-CR05.2: Shared tool blast radius: ScrapeWebsiteTool - â”‚
 â”‚   ğŸ”´ ScrapeWebsiteTool shared by 4 agents                          â”‚
 â”‚   ğŸ”´ WebsiteSearchTool shared by 3 agents                          â”‚
 â”‚   ğŸ”´ CalculatorTool shared by 3 agents                             â”‚
 â”‚   ğŸ”´ SEC10QTool shared by 3 agents                                 â”‚
 â”‚   ğŸ”´ SEC10KTool shared by 3 agents                                 â”‚
 â”‚                                                                   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 SurpriseTravelCrew (3 agents, sequential)  19/100
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                                                                   â”‚
 â”‚   personalized_ac.. â”€â”€â–¶ restaurant_scout â”€â”€â–¶ itinerary_compi..    â”‚
 â”‚     personalized_activity_planner: SerperDevTool, ScrapeWebsiteTo â”‚
 â”‚     restaurant_scout: SerperDevTool, ScrapeWebsiteTool            â”‚
 â”‚     itinerary_compiler: SerperDevTool                             â”‚
 â”‚                                                                   â”‚
 â”‚   â˜¢ STRATUM-CR05: Shared tool blast radius: SerperDevTool -> 3 ag â”‚
 â”‚   ğŸ”´ SerperDevTool shared by 3 agents                              â”‚
 â”‚   ğŸ”´ ScrapeWebsiteTool shared by 2 agents                          â”‚
 â”‚                                                                   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 MatchToProposalCrew (2 agents, sequential)  14/100
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                                                                   â”‚
 â”‚   cv_reader â”€â”€â–¶ matcher                                           â”‚
 â”‚     cv_reader: FileReadTool                                       â”‚
 â”‚     matcher: FileReadTool, CSVSearchTool, SerperDevTool (+1)      â”‚
 â”‚                                                                   â”‚
 â”‚   âš  STRATUM-CR06: 'Matcher' bypasses 'CV Reader' -- reads Crewai  â”‚
 â”‚   âš  BYPASS: Matcher reads Crewai Tools directly                   â”‚
 â”‚   ğŸ”´ FileReadTool shared by 2 agents                               â”‚
 â”‚                                                                   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 +26 more crews (stratum scan . --verbose to see all)

 RISK SCORE â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  69 / 100
            â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”
            4 critical Â· 5 high Â· 8 medium Â· 1 low


 â”€â”€â”€ FIX THESE FIRST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

 â‘  Add input validation on shared tools                   â–‘ 30 min
   Resolves 3 findings (3 critical)

   Activity Planner is shared by 3 agents in
   SurpriseTravelCrew. If Activity Planner returns poisoned
   results (SEO spam, prompt injection in API response), all 3
   agents process that payload. One compromised API response
   corrupts your entire crew in a single request.

   Fix:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ class ValidatedSearch(BaseTool):                       â”‚
   â”‚       def _run(self, query: str) -> str:               â”‚
   â”‚           raw = SerperDevTool()._run(query)            â”‚
   â”‚  +        if contains_injection_patterns(raw):         â”‚
   â”‚  +            raise ValueError("Suspicious content")   â”‚
   â”‚           return raw                                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Apply to: recruitment/crew.py, stock_analysis/crew.py,
surprise_travel/crew.py

   ğŸ“ Matches real breach: ServiceNow Now Assist Shared Resource
      Your agent's shared resource amplifies compromise matches
      the pattern from ServiceNow Now Assist Shared Resource
      (March 2025).


 â‘¡ Add human review on outbound tasks                      â–‘ 5 min
   Resolves 4 findings (1 critical + 3 high)

   Your GameBuilderCrew reads external input and sends to
   external service with no human check between them. If
   someone sends a prompt injection via external input, your
   agent will send data to whatever destination the injection
   specifies. This matches the EchoLeak breach pattern (March
   2024), where a crafted email caused an agent to exfiltrate
   an entire inbox to an external server.

   Fix:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ task = Task(                                             â”‚
   â”‚       description="...",                                 â”‚
   â”‚  +    human_input=True   # review before external calls  â”‚
   â”‚   )                                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Apply to: config/agents.yaml, email_filter_crew/email_filter_crew.py,
instagram_post/agents.py (+4 more)

   ğŸ“ Matches real breach: Microsoft Copilot EchoLeak
      Your agent's data-to-external without review matches the
      pattern from Microsoft Copilot EchoLeak (March 2024).


 â‘¢ Fix data access bypass                                 â–‘ 15 min
   Resolves 2 findings (2 high)

   You built senior_engineer_agent as a filter to sanitize
   inputs before qa_engineer_agent processes them. But
   qa_engineer_agent has direct access to the same data source
   data source. It reads raw data without going through your
   filter. Your filter is architecturally irrelevant â€” it runs,
   but the unfiltered path exists in parallel.



 â”€â”€â”€ ALSO WORTH FIXING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

 Â· 29 external API calls have no error handling
 Â· 29 HTTP calls have no timeout
 Â· 5 crews with findings (13 agents) have no checkpointing
 Â· No validation between agent handoffs in StockAnalysisCrew (4 agents)

 â”€â”€â”€ 10 architecture risks Â· 6 operational recommendations Â· 2 hygiene items Â·
Full details: stratum scan . --verbose

 â†’ Run stratum scan . --fix to auto-fix 6 of 18 findings

 .stratum/history.jsonl saved (1 scans)

                                     stratum v0.2 Â·
github.com/stratum-systems/stratum-cli
  Run 'stratum scan . --fix' to auto-fix 6 findings.
